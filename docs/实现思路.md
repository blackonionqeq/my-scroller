

## 极简版本虚拟列表

### 功能
支持单个内容固定高度的虚拟列表（只加载可视区域+缓冲区域的数据）、虚拟滚动（滚动时也一样）。



### 实现思路

#### 初始化阶段
1. 检测可视区行数（可视区域 / 单内容高度）。
2. 获取可视+缓冲区行数（可视区行数 + 缓冲区行数）。在初次滚动时缓冲区行数可能要 * 2，因为上方从0行开始，也就是上面缺缓冲区，但滚动后缓冲区最多也就 缓冲区行数 * 2了，可先渲染，后续不会变动。
3. 渲染可视+缓冲区内容。用行数 * 每行数量获得要渲染的总数量，并在原始数据里做一个切片，从0开始，长度为总数量。
4. 布局。基本逻辑是实现父容器（relative）和两个子容器（一个是滚动容器，一个是渲染可视区域数据的，两者都是absolute）。可视区域内，如果一行有多个，注意写好flex wrap和每个内容的宽度。

#### 滚动时逻辑
1. 根据滚动容器高度，计算要显示的数据范围，获得起始行数(滚动高度 / 单内容高度)。
2. 修正起始下标。因为缓冲区包含上方，所以要减去缓冲行，且判断减去后大于等于0，获得修正后的起始下标。
3. 进行一次渲染。逻辑和初始化时类似，根据起始下标、可视+缓冲区行数、原始数据，获得渲染数据的数组切片，进行重渲染。

## 增加header插槽，并根据高度变化动态调整渲染视图

### 实现思路
1. 增加在wrapper内部，滚动容器前面增加header容器和插槽
2. 用ResizeObserver检测插槽高度变化，变化时调整父容器总高度并让可视区域重渲染
3. 重渲染逻辑：增加判断，当header区高度大于滚动位置时，不让可视区域滚动（因为可视区域内容还未到达视野顶部）；小于时，滚动位置减header区高度，得到可视区域的滚动高度，后面的逻辑类似以前，也就是计算起始行数，计算渲染内容这些。